[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Regression Monkey Nonparametric Statistics",
    "section": "",
    "text": "Preface",
    "crumbs": [
      "Preface"
    ]
  },
  {
    "objectID": "index.html#å®Ÿè¡Œç’°å¢ƒ",
    "href": "index.html#å®Ÿè¡Œç’°å¢ƒ",
    "title": "Regression Monkey Nonparametric Statistics",
    "section": "ğŸ’» å®Ÿè¡Œç’°å¢ƒ",
    "text": "ğŸ’» å®Ÿè¡Œç’°å¢ƒ\n\n\n\n\né …ç›®\nversion\n\n\n\n\nOS\nUbuntu 24.04.3 LTS x86_64\n\n\nCPU\nAMD Ryzen 9 7950X (32) @ 5.883GHz\n\n\nGPU\nNVIDIA GeForce RTX 4070\n\n\nPython\n3.13.7\n\n\ngcc\n13.3.0\n\n\ncuda\n13.0\n\n\nNVIDIA-Driver\n580.65.06",
    "crumbs": [
      "Preface"
    ]
  },
  {
    "objectID": "index.html#contributions",
    "href": "index.html#contributions",
    "title": "Regression Monkey Nonparametric Statistics",
    "section": "ğŸ§© Contributions",
    "text": "ğŸ§© Contributions\n\nãƒãƒ¼ãƒˆã«é–¢ã—ã¦BUG/Typos/ä¸æ­£ç¢ºãªè¡¨è¨˜ã‚’è¦‹ã¤ã‘ãŸå ´åˆï¼Œã¾ãšGitHub Issuesã§Issue Raiseã—ã¦ã„ãŸã ã‘ã‚‹ã¨åŠ©ã‹ã‚Šã¾ã™\nå³ã‚µã‚¤ãƒ‰ãƒãƒ¼ã® Report an issue ã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã“ã¨ã§ï¼ŒIssueä½œæˆç”»é¢ã«é·ç§»ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™\nä¿®æ­£ã®å¿…è¦æ€§ã®åˆ¤æ–­ã¯RyoNakãŒæœ€çµ‚çš„ã«ã¯åˆ¤æ–­ã—ã¾ã™ãŒï¼Œåºƒãè­°è«–ã§ããŸã‚‰å¹¸ã„ã§ã™",
    "crumbs": [
      "Preface"
    ]
  },
  {
    "objectID": "summary.html",
    "href": "summary.html",
    "title": "Book Outline",
    "section": "",
    "text": "Part 1: å¯†åº¦é–¢æ•°ã®æ¨å®š\nTopics\nReferences",
    "crumbs": [
      "Book Outline"
    ]
  },
  {
    "objectID": "summary.html#part-1-å¯†åº¦é–¢æ•°ã®æ¨å®š",
    "href": "summary.html#part-1-å¯†åº¦é–¢æ•°ã®æ¨å®š",
    "title": "Book Outline",
    "section": "",
    "text": "å¯†åº¦é–¢æ•°ã®å½¢çŠ¶ã®æ¨å®šæ‰‹æ³•ã¨ã—ã¦ã®ãƒ’ã‚¹ãƒˆã‚°ãƒ©ãƒ ã®åŸºæœ¬æ€§è³ª\nã‚«ãƒ¼ãƒãƒ«å‹å¯†åº¦é–¢æ•°æ¨å®šé‡ã®åŸºæœ¬æ€§è³ª\n\n\n\nãƒãƒ³ãƒ‘ãƒ©ãƒ¡ãƒˆãƒªãƒƒã‚¯æ³•: ã‚«ãƒ¼ãƒãƒ«å‹æ¨å®šã«ã‚ˆã‚‹çµ±è¨ˆçš„æ€§è³ª(å‰åœ’å®œå½¦ 2025,pp. 1â€“25)\nLockhart (2013)\n\n\n\n\n\nLockhart, R. (2013), â€œNonparametric basics: Lecture notes,â€ Simon Fraser University; https://www.sfu.ca/~lockhart/richard/830/13_3/lectures/nonparametric_basics/notes.pdf.\n\n\nå‰åœ’å®œå½¦ (2025), ãƒãƒ³ãƒ‘ãƒ©ãƒ¡ãƒˆãƒªãƒƒã‚¯æ³•: ã‚«ãƒ¼ãƒãƒ«å‹æ¨å®šã«ã‚ˆã‚‹çµ±è¨ˆçš„æ€§è³ª, çµ±è¨ˆå­¦One point, Tokyo, Japan: å…±ç«‹å‡ºç‰ˆ, p. 128.",
    "crumbs": [
      "Book Outline"
    ]
  },
  {
    "objectID": "notation.html",
    "href": "notation.html",
    "title": "Notaitons",
    "section": "",
    "text": "Noation\nComment\n\n\n\n\n\\(I(A)\\)\nIndicator function",
    "crumbs": [
      "Notaitons"
    ]
  },
  {
    "objectID": "notes/density_estimation/introduction.html",
    "href": "notes/density_estimation/introduction.html",
    "title": "1Â  ãªãœãƒãƒ³ãƒ‘ãƒ©ãƒ¡ãƒˆãƒªãƒƒã‚¯ã‹?",
    "section": "",
    "text": "1.1 1978å¹´ã¨1988å¹´ã§ã®ç”·æ€§ã®å®Ÿè³ªå¯¾æ•°è³ƒé‡‘åˆ†å¸ƒ\nã©ã®ã‚ˆã†ãªçŠ¶æ³ã«ãŠã„ã¦ãƒãƒ³ãƒ‘ãƒ©ãƒ¡ãƒˆãƒªãƒƒã‚¯æ¨å®šãŒå¿…è¦ã«ãªã‚‹ã®ã‹ã‚’ï¼ŒDiNardo et al. (1996) ã‚’ä¾‹ã«èª¬æ˜ã—ãŸã„ã¨æ€ã„ã¾ã™ï¼\nã‚¢ãƒ¡ãƒªã‚«ã§ã¯1980å¹´ä»£ã«è³ƒé‡‘æ ¼å·®ãŒæ‹¡å¤§ã•ã‚ŒãŸã¨ã•ã‚Œã¦ãŠã‚Šï¼Œãã®ç‰¹å¾´ã‚’1979å¹´ã¨1988å¹´ã§ã®ç”·æ€§ã®å®Ÿè³ªå¯¾æ•°è³ƒé‡‘åˆ†å¸ƒã‚’æ¯”è¼ƒã™ã‚‹ã“ã¨ã§æ¤œè¨¼ã—ã¾ã™ï¼\nDatasetã®èª­ã¿è¾¼ã¿\nCode\n#------------------------------------------------------------------------------\n# From BigQuery\n#------------------------------------------------------------------------------\n# # config setup\n# from dotenv import dotenv_values\n# import pathlib\n\n# from regression_monkey_nonparametric import utils as rgm_utils\n\n# ROOT_PATH = pathlib.Path(rgm_utils.git_path_setting())\n# CONFIG = dotenv_values(str(ROOT_PATH / \"env\" / \"config\")) \n\n# GOOGLE_PROJECT = CONFIG['GOOGLE_PROJECT_ID']\n# MEM7988 = rgm_utils.DATASET_CONFIG.dataset['men7988'].source\n\n# # READ DATA FROM BigQuery\n# from google.cloud import bigquery\n\n# client = bigquery.Client(project=CONFIG['GOOGLE_PROJECT_ID'])\n# query = f\"SELECT * FROM {MEM7988}\"\n# df = client.query(query).to_dataframe()\n\n# # Save tmp dataset\n# MEM7988_PATH = ROOT_PATH / \"dataset\" / \"mem7988.parquet\"\n# df.to_parquet(MEM7988_PATH, engine=\"pyarrow\", compression=\"snappy\", index=False)\nCode\n#------------------------------------------------------------------------------\n# From dataset directory\n#------------------------------------------------------------------------------\nimport pathlib\nimport pandas as pd\n\nfrom regression_monkey_nonparametric import utils as rgm_utils\n\nROOT_PATH = pathlib.Path(rgm_utils.git_path_setting())\nMEM7988_PATH = ROOT_PATH / \"dataset\" / \"mem7988.parquet\"\n\ndf = pd.read_parquet(MEM7988_PATH)\ndf.info()\n\n\n&lt;class 'pandas.core.frame.DataFrame'&gt;\nRangeIndex: 151661 entries, 0 to 151660\nData columns (total 15 columns):\n #   Column      Non-Null Count   Dtype  \n---  ------      --------------   -----  \n 0   educ        151661 non-null  Int64  \n 1   exper       151661 non-null  Int64  \n 2   female      151661 non-null  Int64  \n 3   industry    151661 non-null  Int64  \n 4   married     151661 non-null  Int64  \n 5   nonwhite    151661 non-null  Int64  \n 6   occupation  151661 non-null  Int64  \n 7   partt       151661 non-null  Int64  \n 8   region      151661 non-null  Int64  \n 9   smsa        151661 non-null  Int64  \n 10  state       151661 non-null  Int64  \n 11  uhrswk      151661 non-null  Int64  \n 12  wage        151661 non-null  float64\n 13  weight      151661 non-null  float64\n 14  year        151661 non-null  Int64  \ndtypes: Int64(13), float64(2)\nmemory usage: 19.2 MB\nå‰å‡¦ç†\nå…ƒãƒ‡ãƒ¼ã‚¿ã¯åç›®è³ƒé‡‘ãƒ™ãƒ¼ã‚¹ãªã®ã§ï¼ŒFREDãŒæä¾›ã™ã‚‹CPIæ¨ç§»ã‚’ç”¨ã„ã¦ï¼Œ1979å¹´ã‚’åŸºæº–ã¨ã—ã¦è³ƒé‡‘ã‚’å®Ÿè³ªå¤‰æ›ã—ã¾ã™ï¼\nCode\n# CPIå€¤ï¼ˆä¾‹ï¼‰\ncpi_1979 = 76.7\ncpi_1988 = 120.5\ninfla_ratio = cpi_1979 / cpi_1988\n\n# 1988å¹´ãƒ‰ãƒ«ã‚’1979å¹´ãƒ‰ãƒ«ã«æ›ç®—ã™ã‚‹é–¢æ•°\ndef adjust_to_1979(dollar_1988):\n    return dollar_1988 * infla_ratio\n\n# wage åˆ—ã‚’ã‚³ãƒ”ãƒ¼ã—ã¦æ–°ã—ã„åˆ—ã‚’ä½œã‚‹ï¼ˆå¿…è¦ã«å¿œã˜ã¦ä¸Šæ›¸ãå¯ï¼‰\ndf['real_wage'] = df['wage']\n\n# yearãŒ1988ã®è¡Œã ã‘æ›ç®—\nmask_1988 = df['year'] == 1988\ndf.loc[mask_1988, 'real_wage'] = df.loc[mask_1988, 'wage'].apply(adjust_to_1979)\nåŸºæœ¬çµ±è¨ˆé‡\nå¹´åº¦åˆ¥è³ƒé‡‘ã«ã¤ã„ã¦ã®åŸºæœ¬çµ±è¨ˆé‡ã‚’ç¢ºèªã—ã¦ã¿ã¾ã™ï¼\nCode\ngroup_column = ['year']\ndescribe_column = ['real_wage']\n\n# ã‚°ãƒ«ãƒ¼ãƒ—ã”ã¨ã® describe\ngroup_stats = df.groupby(group_column)[describe_column].describe().T\n\n# å…¨ä½“ã® describe\ntotal_stats = df[describe_column].describe().stack()\n\n# å…¨ä½“ã®Indexæ•´ç†\ntotal_stats = total_stats.to_frame(name=\"Total\")\ntotal_stats.index = total_stats.index.swaplevel(0, 1)\ntotal_stats = total_stats.sort_index()\n\n# groupby ã®çµæœã¨çµåˆ\nresult = pd.concat([group_stats, total_stats], axis=1)\nresult.columns.name = group_column[0]\nresult\n\n\n\n\n\n\n\n\n\nyear\n1979\n1988\nTotal\n\n\n\n\nreal_wage\ncount\n77000.000000\n74661.000000\n151661.000000\n\n\nmean\n7.091254\n7.068542\n7.080073\n\n\nstd\n3.798345\n4.355758\n4.082278\n\n\nmin\n1.000000\n1.018423\n1.000000\n\n\n25%\n4.349998\n3.946388\n4.137344\n\n\n50%\n6.349998\n6.288762\n6.339996\n\n\n75%\n8.888885\n8.911203\n8.911203\n\n\nmax\n99.989990\n84.826127\n99.989990\nå®Ÿè³ªè³ƒé‡‘ã§ã¯ãªã„ã®ã§ï¼Œæ³¨æ„ãŒå¿…è¦ã§ã™ãŒï¼Œå°‘ãªãã¨ã‚‚åç›®ã§ã¯1988å¹´ã®ã»ã†ãŒè³ƒé‡‘ã®åˆ†æ•£ãŒå¤§ãããªã£ã¦ã„ã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ï¼ ä¸€èˆ¬ã«ï¼Œå¯¾æ•°è³ƒé‡‘ã®åˆ†å¸ƒã¯æ­£è¦åˆ†å¸ƒã«ã‚ˆã£ã¦ã‚ˆãè¿‘ä¼¼ã§ãã‚‹ã¨ã•ã‚Œã¦ã„ã‚‹ã®ã§ï¼Œæ¬¡ã«å¯¾æ•°å¤‰æ›ã‚’å‡¦ç†ã—ãŸä¸Šã§åŒã˜ãåŸºæœ¬çµ±è¨ˆé‡ã‚’ç¢ºèªã—ã¦ã¿ã¾ã™ï¼\nCode\nimport numpy as np\n\nfrom regression_monkey_nonparametric.eda.pandas.summary import create_grouped_describe\n\n# è³ƒé‡‘ã®å¯¾æ•°å¤‰æ›\ndf['log_wage'] = np.log(df['real_wage'])\n\n# åŸºæœ¬çµ±è¨ˆé‡\ncreate_grouped_describe(df, group_column, ['log_wage'])\n\n\n\n\n\n\n\n\n\nyear\n1979\n1988\nTotalGroup\n\n\ncolumn\nstat\n\n\n\n\n\n\n\nlog_wage\ncount\n77000.000000\n74661.000000\n151661.000000\n\n\nmean\n1.832631\n1.791661\n1.812462\n\n\nstd\n0.504078\n0.573266\n0.539636\n\n\nmin\n0.000000\n0.018255\n0.000000\n\n\n25%\n1.470175\n1.372801\n1.420054\n\n\n50%\n1.848455\n1.838764\n1.846878\n\n\n75%\n2.184802\n2.187309\n2.187309\n\n\nmax\n4.605070\n4.440604\n4.605070\nã“ã®æ¨å®šçµæœã‚’ãƒ™ãƒ¼ã‚¹ã«å¯¾æ•°è³ƒé‡‘ã«ã¤ã„ã¦ã®ç¢ºç‡å¯†åº¦é–¢æ•°ã‚’å¯è¦–åŒ–ã—ã¾ã™ï¼\nCode\nimport matplotlib.pyplot as plt\nfrom cycler import cycler\nfrom matplotlib.ticker import FuncFormatter\n\nfrom regression_monkey_nonparametric.eda import visualize as rmn_viz\n\ncolor_palette = rmn_viz.okabe_ito_color\nplt.rcParams[\"axes.prop_cycle\"] = cycler(color=color_palette[1:])\nplt.rcParams[\"font.family\"] = \"Meiryo\"\n\nminimumwage_79 = np.log(2.90)\nminimumwage_88 = np.log(3.35 * infla_ratio)\nCode\nfrom scipy.stats import norm\n\n# Compute mean and std of log_wage by year\ngroup_stats = df[\"log_wage\"].groupby(df[\"year\"]).agg([\"mean\", \"std\"])\n\n# Extract values for each year\nmean_79 = group_stats.loc[1979, \"mean\"]\nstd_79 = group_stats.loc[1979, \"std\"]\n\nmean_88 = group_stats.loc[1988, \"mean\"]\nstd_88 = group_stats.loc[1988, \"std\"]\n\n\n# X-axis\nx = np.linspace(np.log(1), max(df['log_wage']), 500)\n\nplt.figure(figsize=(9.6, 6))\nax = plt.gca()\n\n# Normal distributions\nax.plot(x, norm.pdf(x, mean_79, std_79), label=\"1979\", linewidth=2)\nax.plot(x, norm.pdf(x, mean_88, std_88), label=\"1988\", linewidth=2)\n\n# Limit x-axis (log scale)\nplt.xlim(np.log(1.6), np.log(70))  # e.g., show wages from 1 to 15\nplt.ylim(0, 1.1)  # e.g., show wages from 1 to 15\n\n# æœ€ä½è³ƒé‡‘ã®ç¸¦ç·š\nvlines = [\n    (minimumwage_79, \"1979\\nMin Wage\", -0.05),\n    (minimumwage_88, \"1988\\nMin Wage\", -0.15),\n]\n\nymax = ax.get_ylim()[1]\nlabel_y = ymax * 0.95\n\nfor x, label, x_offset in vlines:\n    # Draw vertical line just below text\n    line_ymax = label_y * 0.95  # slightly below label\n    ax.axvline(\n        x,\n        color=color_palette[-1],\n        linestyle=\"--\",\n        ymin=0,\n        ymax=line_ymax / ymax,\n    )\n\n    # place text slightly above top of plot\n    ymax = ax.get_ylim()[1]\n    ax.text(\n        x + x_offset,\n        line_ymax,\n        label,\n        rotation=0,\n        ha=\"left\",\n        va=\"bottom\",\n        color=color_palette[0],\n    )\n\n\n# Format x-axis: exp back to wage scale\ndef exp_formatter(x, pos):\n    return f\"Log({np.exp(x):.1f})\"  # one decimal, original scale\n\n\n# remove box\nfor spine in plt.gca().spines.values():\n    spine.set_visible(False)\n\nax.xaxis.set_major_formatter(FuncFormatter(exp_formatter))\n\n\nplt.xlabel(\"log_wage\")\nplt.ylabel(\"Density\")\nplt.title(\"æ­£è¦åˆ†å¸ƒã‚’ç”¨ã„ãŸãƒ‘ãƒ©ãƒ¡ãƒˆãƒªãƒƒã‚¯æ¨å®š\", fontsize=14)\nplt.xticks(fontsize=10)\nplt.yticks(fontsize=10)\nplt.legend(\n    fontsize=12, frameon=False, loc=\"upper right\", bbox_to_anchor=(1, 0.9)\n)\nplt.grid(axis=\"y\", alpha=0.3)\n\nplt.show()\n\n\n\n\n\n\n\n\nFigureÂ 1.1\n1979å¹´ã¨æ¯”è¼ƒã—ã¦1988å¹´è³ƒé‡‘ã®åˆ†æ•£ãŒå¤§ãããªã£ã¦ã„ã‚‹ã®ã§ï¼Œ1988å¹´ã®è³ƒé‡‘åˆ†å¸ƒã®è£¾ãŒåšããªã‚‹ã®ã¯è‡ªç„¶ã§ã™ãŒï¼Œæœ€ä½è³ƒé‡‘ã®å¤‰åŒ–ãŒã©ã®å±¤ã¸ã®å½±éŸ¿ã‚’ä¸ãˆãŸã®ã‹ã¯æ¨æ¸¬ã™ã‚‹ã“ã¨ãŒã§ãã¾ã›ã‚“ï¼Œ\nãƒãƒ³ãƒ‘ãƒ©ãƒ¡ãƒˆãƒªãƒƒã‚¯æ¨å®š\nãƒ‘ãƒ©ãƒ¡ãƒˆãƒªãƒƒã‚¯æ¨å®šã§ã¯æ­£è¦åˆ†å¸ƒã‚’ä»®å®šã—ã¦ç¢ºç‡å¯†åº¦é–¢æ•°ã‚’ç¢ºèªã—ã¾ã—ãŸãŒï¼Œæ¬¡ã«å¯†åº¦é–¢æ•°ã®é–¢ä¿‚å½¢ã«éç¨‹ã‚’ç½®ã‹ãšã«æ¨å®šã—ã¦ã¿ã¾ã™ï¼ bw_method=0.1ã¨ã—ã¦ï¼ŒKDE plotã‚’å®Ÿæ–½ã—ãŸã®ãŒä»¥ä¸‹ã§ã™:\nCode\n# kdeplot\nplt.figure(figsize=(9.6, 6))\nax = plt.gca()\ndf.groupby([\"year\"])[\"log_wage\"].plot.kde(bw_method=0.1, ax=ax)\n\n# Limit x-axis (log scale)\nplt.xlim(np.log(1.6), np.log(70))  # e.g., show wages from 1 to 15\nplt.ylim(0, 1.1)  # e.g., show wages from 1 to 15\n\n# æœ€ä½è³ƒé‡‘ã®ç¸¦ç·š\nymax = ax.get_ylim()[1]\nlabel_y = ymax * 0.95\n\nfor x, label, x_offset in vlines:\n    # Draw vertical line just below text\n    line_ymax = label_y * 0.95  # slightly below label\n    ax.axvline(\n        x,\n        color=color_palette[-1],\n        linestyle=\"--\",\n        ymin=0,\n        ymax=line_ymax / ymax,\n    )\n\n    # place text slightly above top of plot\n    ymax = ax.get_ylim()[1]\n    ax.text(\n        x + x_offset,\n        line_ymax,\n        label,\n        rotation=0,\n        ha=\"left\",\n        va=\"bottom\",\n        color=color_palette[0],\n    )\n\n\n# remove box\nfor spine in plt.gca().spines.values():\n    spine.set_visible(False)\n\nax.xaxis.set_major_formatter(FuncFormatter(exp_formatter))\n\n\nplt.xlabel(\"log_wage\")\nplt.ylabel(\"Density\")\nplt.title(\"ãƒãƒ³ãƒ‘ãƒ©ãƒ¡ãƒˆãƒªãƒƒã‚¯æ¨å®š\", fontsize=14)\nplt.xticks(fontsize=10)\nplt.yticks(fontsize=10)\nplt.legend(\n    fontsize=12, frameon=False, loc=\"upper right\", bbox_to_anchor=(1, 0.9)\n)\nplt.grid(axis=\"y\", alpha=0.3)\n\nplt.show()\n\n\n\n\n\n\n\n\nFigureÂ 1.2\nFigureÂ 1.2 ã§ã¯ FigureÂ 1.1 ã§èª­ã¿å–ã‚Œãªã‹ã£ãŸè³ƒé‡‘åˆ†å¸ƒã®ç‰¹å¾´ãŒç¢ºèªã§ãã¾ã™\nä¸Šè¨˜ã®æƒ…å ±ã‹ã‚‰ï¼Œå®Ÿè³ªæœ€ä½è³ƒé‡‘æ°´æº–ã®ä½ä¸‹ãŒï¼Œã€Œä½è³ƒé‡‘ã€ã‚°ãƒ«ãƒ¼ãƒ—ã®å®Ÿè³ªè³ƒé‡‘æ¸›å°‘ã®æ–¹å‘æ€§ã«å½±éŸ¿ã‚’ä¸ãˆãŸãŸã‚ï¼Œè³ƒé‡‘æ ¼å·®ãŒåºƒãŒã£ãŸã¨æ¨æ¸¬ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ï¼\nãƒ‘ãƒ©ãƒ¡ãƒˆãƒªãƒƒã‚¯æ¨å®šã¯ï¼Œé–¢æ•°å½¢ã®å®¶åº­ãŒã‚ã‚‹ç¨‹åº¦è‰¯ã„è¿‘ä¼¼ã«ãªã£ã¦ã„ã‚‹å ´åˆã«ã¯å¼·åŠ›ãªãƒ„ãƒ¼ãƒ«ã§ã™ãŒï¼Œä»®å®šï¼ˆå¯¾æ•°è³ƒé‡‘åˆ†å¸ƒã¯æ­£è¦åˆ†å¸ƒã§è¿‘ä¼¼ã§ãã‚‹ï¼‰ãŒä¸é©åˆ‡ãªå ´åˆã§ã¯ï¼Œãƒ‡ãƒ¼ã‚¿ã‹ã‚‰ã‚¤ãƒ³ã‚µã‚¤ãƒˆã‚’æŠ½å‡ºã™ã‚‹ã“ã¨ãŒé›£ã—ããªã‚Šã¾ã™ã—ï¼Œèª¤ã£ãŸç†è§£ã‚’ã—ã¦ã—ã¾ã†å¯èƒ½æ€§ã‚‚ã‚ã‚Šã¾ã™ï¼",
    "crumbs": [
      "Part 1: å¯†åº¦é–¢æ•°ã®æ¨å®š",
      "<span class='chapter-number'>1</span>Â  <span class='chapter-title'>ãªãœãƒãƒ³ãƒ‘ãƒ©ãƒ¡ãƒˆãƒªãƒƒã‚¯ã‹?</span>"
    ]
  },
  {
    "objectID": "notes/density_estimation/introduction.html#å¹´ã¨1988å¹´ã§ã®ç”·æ€§ã®å®Ÿè³ªå¯¾æ•°è³ƒé‡‘åˆ†å¸ƒ",
    "href": "notes/density_estimation/introduction.html#å¹´ã¨1988å¹´ã§ã®ç”·æ€§ã®å®Ÿè³ªå¯¾æ•°è³ƒé‡‘åˆ†å¸ƒ",
    "title": "1Â  ãªãœãƒãƒ³ãƒ‘ãƒ©ãƒ¡ãƒˆãƒªãƒƒã‚¯ã‹?",
    "section": "",
    "text": "ã©ã¡ã‚‰ã‚‚æœ€ä½è³ƒé‡‘å‰å¾Œã§densityã®å‚¾ããŒæ€¥ã«ãªã£ã¦ã„ã‚‹\n1979å¹´ã§ã¯æœ€ä½è³ƒé‡‘ã®ã¨ã“ã‚ã§å±±ãŒï¼‘ã¤ã‚ã‚Š(=è³ƒé‡‘ãŒãã®æ°´æº–ã§é›†ä¸­ã—ã¦ã„ã‚‹)ï¼Œæœ€ä½è³ƒé‡‘ãŒè³ƒé‡‘å¼•ãä¸‹ã’ã‚’é˜²ãå½¹å‰²ã‚’æœãŸã—ã¦ã„ã‚‹\n1988å¹´ã§ã¯æœ€ä½è³ƒé‡‘å‰å¾Œã§å±±ã¯ãªãï¼Œ1979å¹´ã®ã‚ˆã†ã«è³ƒé‡‘ã®å¼•ãä¸‹ã’ã‚’é˜²ãå½¹å‰²ã‚’æœãŸã—ã¦ã„ã‚‹ã¨ã¯è§£é‡ˆã§ããªã„\n\n\n\n\n\n\n\nDiNardo, J., Fortin, N. M., and Lemieux, T. (1996), â€œLabor market institutions and the distribution of wages, 1973-1992: A semiparametric approach,â€ Econometrica, USA: The Econometric Society, 64, 1001â€“1044. https://doi.org/10.2307/2171954.",
    "crumbs": [
      "Part 1: å¯†åº¦é–¢æ•°ã®æ¨å®š",
      "<span class='chapter-number'>1</span>Â  <span class='chapter-title'>ãªãœãƒãƒ³ãƒ‘ãƒ©ãƒ¡ãƒˆãƒªãƒƒã‚¯ã‹?</span>"
    ]
  },
  {
    "objectID": "notes/density_estimation/histogram.html",
    "href": "notes/density_estimation/histogram.html",
    "title": "2Â  ãƒ’ã‚¹ãƒˆã‚°ãƒ©ãƒ ã®æ€§è³ª",
    "section": "",
    "text": "2.1 çµŒé¨“åˆ†å¸ƒé–¢æ•°\nãƒãƒ³ãƒ‘ãƒ©ãƒ¡ãƒˆãƒªãƒƒã‚¯ãªåˆ†å¸ƒé–¢æ•°æ¨å®šé‡ã¨ã—ã¦çµŒé¨“åˆ†å¸ƒé–¢æ•°ãŒã‚ã‚Šã¾ã™ï¼\nçµŒé¨“åˆ†å¸ƒé–¢æ•°(EDF)ã¯ï¼Œåˆ†å¸ƒé–¢æ•°ã«ã¤ã„ã¦ã®ä¸åã§ä¸€è‡´æ€§ã‚’æŒã¤æ¨å®šé‡ã¨ã—ã¦çŸ¥ã‚‰ã‚Œã¦ã„ã¾ã™ï¼",
    "crumbs": [
      "Part 1: å¯†åº¦é–¢æ•°ã®æ¨å®š",
      "<span class='chapter-number'>2</span>Â  <span class='chapter-title'>ãƒ’ã‚¹ãƒˆã‚°ãƒ©ãƒ ã®æ€§è³ª</span>"
    ]
  },
  {
    "objectID": "notes/density_estimation/histogram.html#çµŒé¨“åˆ†å¸ƒé–¢æ•°",
    "href": "notes/density_estimation/histogram.html#çµŒé¨“åˆ†å¸ƒé–¢æ•°",
    "title": "2Â  ãƒ’ã‚¹ãƒˆã‚°ãƒ©ãƒ ã®æ€§è³ª",
    "section": "",
    "text": "Definition 2.1 çµŒé¨“åˆ†å¸ƒé–¢æ•°\n\\(\\{X_1, X_2, \\cdots, X_n\\}\\) ã¨ã„ã†ãƒ‡ãƒ¼ã‚¿ãŒä¸ãˆã‚‰ã‚ŒãŸã¨ãï¼Œç‰¹å®šã®å€¤ \\(x\\) ã§ã®çµŒé¨“åˆ†å¸ƒé–¢æ•°ã¯æ¬¡ã®ã‚ˆã†ã«å®šç¾©ã•ã‚Œã‚‹\n\\[\n\\begin{align}\nF_n(x) = \\frac{1}{n} \\sum_{i=1}^n\\mathbb{I}(X_i \\leq x)\n\\end{align}\n\\]\n\n\n\nBias, variance, MSE and RMSE\nä½•ã‹ã—ã‚‰ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ \\(\\theta\\) ã®æ¨å®šé‡ã®æ€§è³ªã‚’è€ƒãˆã‚‹ã¨ãï¼ŒåŸºæœ¬çš„ã«ã¯æ¨å®šèª¤å·®\n\\[\n\\hat\\theta - \\theta\n\\]\nã®åˆ†å¸ƒã«ã¤ã„ã¦ã¾ãšè€ƒãˆã¾ã™ï¼ãƒãƒ³ãƒ‘ãƒ©ãƒ¡ãƒˆãƒªãƒƒã‚¯ã®i.i.dã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ãƒ¢ãƒ‡ãƒ«ã«ãŠã„ã¦ã¯ï¼Œ\n\\[\n\\hat F(x) - F(x)\n\\]\nã«ãªã‚Šã¾ã™ï¼ã“ã®è©•ä¾¡æ‰‹æ³•ã®ï¼‘ä¾‹ã¨ã—ã¦RMSEãŒæŒ™ã’ã‚‰ã‚Œã¾ã™ï¼\n\\[\n\\operatorname{RMSE} = \\sqrt{\\mathbb E_{\\pmb\\theta}[(\\hat\\theta - \\theta)^2]}\n\\]\nRMSEã®å˜ä½ã¯ \\(\\theta\\) ã®å˜ä½ã¨åŒã˜ãªã®ã§ï¼Œèª¤å·®ã®ã‚¹ã‚±ãƒ¼ãƒ«ã‚’ç›´æ„Ÿçš„ã«ç†è§£ã—ã‚„ã™ã„ã¨ã„ã†ãƒ¡ãƒªãƒƒãƒˆãŒã‚ã‚Šã¾ã™ï¼ãŸã ã—ï¼Œæ¨å®šé‡ã®æ€§è³ªã‚’è€ƒãˆã‚‹ã¨ãã¯MSEã®ã»ã†ãŒå–ã‚Šå›ã—ãŒè‰¯ã„ã¨ããŒå¤šã„ã®ã§MSEã®æ¬¡ã«è€ƒãˆã¾ã™ï¼\n\nDefinition 2.2 MSE\n\n\\[\n\\begin{align}\n\\operatorname{MSE}\n  &= \\mathbb E_{\\pmb\\theta}[(\\hat\\theta - \\theta)^2] \\\\\n  &= \\mathbb E_{\\pmb\\theta}[(\\hat\\theta - \\mathbb E_{\\pmb\\theta}[\\hat\\theta] + \\mathbb E_{\\pmb\\theta}[\\hat\\theta] - \\theta)^2] \\\\\n  &= \\mathbb E_{\\pmb\\theta}[(\\hat\\theta - \\mathbb E_{\\pmb\\theta}[\\hat\\theta])^2] + \\mathbb E_{\\pmb\\theta}[(\\mathbb E_{\\pmb\\theta}[\\hat\\theta] - \\theta)^2] + 2\\mathbb E_{\\pmb\\theta}[(\\hat\\theta - \\mathbb E_{\\pmb\\theta}[\\hat\\theta])(\\mathbb E_{\\pmb\\theta}[\\hat\\theta] - \\theta)] \\\\\n  &= \\mathbb E_{\\pmb\\theta}[(\\hat\\theta - \\mathbb E_{\\pmb\\theta}[\\hat\\theta])^2] + (\\mathbb E_{\\pmb\\theta}[\\hat\\theta] - \\theta)^2 \\\\\n  &= \\operatorname{Variance} + \\operatorname{Bias}^2\n\\end{align}\n\\]\n\n\nUnibasedness of EDF\n\nProposition 2.1 çµŒé¨“åˆ†å¸ƒé–¢æ•°ã¨ä¸åæ€§\n\\[\n\\mathbb E[F_n(x)] = F(x)\n\\]\n\n\nProof. \\[\n\\begin{align}\n\\mathbb E[F_n(x)]\n  &= \\mathbb E\\left[\\frac{1}{n}\\sum_{i=1}^nI(X_i \\leq x)\\right] \\\\\n  &= \\frac{1}{n}\\sum_{i=1}^n\\mathbb E[I(X_i \\leq x)] \\\\\n  &= \\frac{1}{n}\\sum_{i=1}^n\\mathbb P(X_i \\leq x)\\\\\n  &= \\frac{1}{n}\\sum_{i=1}^nF(x)\\\\\n  &= F(x)\n\\end{align}\n\\]\n\\[\\tag*{$\\blacksquare$}\\]\n\n\nVariance of EDF\n\nProposition 2.2 çµŒé¨“åˆ†å¸ƒé–¢æ•°ã¨åˆ†æ•£\n\\[\n\\begin{align}\n\\operatorname{Var}(F_n(x)) = \\frac{F(x)(1- F(x))}{n}\n\\end{align}\n\\]\n\n\nProof. \\[\n\\begin{align}\n\\operatorname{MSE}\n  &= \\operatorname{Var}(F_n(x))\\\\\n  &= \\frac{1}{n^2}\\sum_{i=1}^n\\operatorname{Var}[I(X_i \\leq x)]\\\\\n  &= \\frac{1}{n}F(x)(1- F(x))\n\\end{align}\n\\]\n\\[\\tag*{$\\blacksquare$}\\]\n\n\n\nRemark 2.1. \n\nMSEã¯ \\(1/n\\) ã®å¤§ãã•ã«æ¯”ä¾‹ã™ã‚‹ = \\(\\mathcal{O}(n^{-1})\\)\nRMSEã¯ \\(1/\\sqrt{n}\\) ã®å¤§ãã•ã«æ¯”ä¾‹ã™ã‚‹ = \\(\\mathcal{O}(\\sqrt{n}^{-1})\\)\n\n\n\n\nStandard Errors and Interval Estimation\n\\(F(x)\\) ã®Pointwise Confidence Intervalã‚’è€ƒãˆã¾ã™ï¼PropositionÂ 2.2 ã‚ˆã‚Š\n\n\\[\n\\begin{align}\n\\operatorname{SE} \\equiv \\sigma_{F_n(x)} = \\sqrt{\\frac{F(x)(1- F(x))}{n}}\n\\end{align}\n\\]\n\nCLTã‚ˆã‚Š\n\n\\[\n\\begin{align}\n\\frac{F_n(x) - F(x)}{\\sigma_{F_n(x)}} \\overset{d}{\\to} N(0, 1) \\label{eq-clt}\n\\end{align}\n\\]\n\nã¤ã¾ã‚Šæ¼¸è¿‘çš„ã«ï¼Œ\\(x\\) ã«ãŠã‘ã‚‹ \\(1 - \\alpha\\) Pointwise confidence intervalã¯ï¼Œ\\(z_\\alpha\\) ã‚’critical point(æ£„å´é™ç•Œ)ã¨ã™ã‚‹ã¨\n\n\\[\n\\begin{align}\n\\left| \\frac{F_n(x) - F(x)}{\\sigma_{F_n(x)}} \\right| \\leq z_{\\alpha/2} \\label{eq-interval}\n\\end{align}\n\\]\n\nã‚’æº€ãŸã™Intervalã‚’å°å‡ºã™ã‚Œã°è‰¯ã„ã“ã¨ã«ãªã‚Šã¾ã™ï¼\n\n\n\n\n\n\nTip\n\n\n\nãªãŠã“ã“ã§ã¯èª¬æ˜ã—ãªã„ã§ã™ãŒï¼Œ\\(n\\) ãŒå¤§ãããªã‚‹ã«ã¤ã‚Œã¦ï¼Œ\\(F_n(x)\\) ã¯ \\(x\\) ã«ã¤ã„ã¦ä¸€æ§˜ã« \\(F(x)\\) ã«åæŸã™ã‚‹ã“ã¨ãŒçŸ¥ã‚‰ã‚Œã¦ã„ã¾ã™ï¼\n\nTheorem 2.1 Glivenko-Cantelliã®å®šç†\nç¢ºç‡ \\(1\\) ã§\n\n\\[\n\\begin{align}\n\\sup_{x\\in\\mathbb R} |F_n(x) - F(x)| \\to 0\n\\end{align}\n\\]\n\n\n\n\nPlugin Procedure\n\\(\\eqref{eq-interval}\\) ã‚’è¨ˆç®—ã™ã‚‹ãŸã‚ã«ã¯ \\(\\sigma_{F_n(x)}\\) ãŒå¿…è¦ã«ãªã‚Šã¾ã™ãŒï¼Œ\\(\\sqrt{F(x)(1- F(x))/n}\\) ã¨unknown parameterã‚’å«ã‚“ã§ã—ã¾ã£ã¦ã„ã¾ã™ï¼ãã“ã§ï¼Œ\\(\\sigma_{F_n(x)}\\) ä»£æ›¿æ‰‹æ®µã¨ã—ã¦\n\n\\[\n\\begin{align}\n\\hat\\sigma_{F_n(x)} = \\sqrt{\\frac{F_n(x)(1- F_n(x))}{n}}\n\\end{align}\n\\]\n\n\\(F(x)\\) ã®éƒ¨åˆ†ã« \\(F_n(x)\\) ã‚’ä»¥ä¸‹ã®ã‚ˆã†ã«pluginã™ã‚‹ã®ã§Plugin Procedureã¨å‘¼ã‚“ã ã‚Šã—ã¾ã™ï¼\n\n\\[\n\\begin{align}\n\\frac{F_n(x) - F(x)}{\\hat\\sigma_{F_n(x)}} \\label{eq-plugin}\n\\end{align}\n\\]\n\næ¬¡ã«ï¼Œ\\(\\eqref{eq-plugin}\\) ã®æ¼¸è¿‘åˆ†å¸ƒã‚’è€ƒãˆã¾ã™ï¼\n\\[\ng(t) = t(1 - t)\n\\]\nã¯ \\(t \\in (0, 1)\\) ã§é€£ç¶šãªã®ã§é€£ç¶šå†™åƒå®šç†ã‚ˆã‚Šï¼Œ\\(F_n(x) \\overset{p}{\\to} F(x)\\) ã§ã‚ã‚‹ã®ã§\n\\[\nF_n(x)(1- F_n(x)) \\overset{p}{\\to} F(x)(1- F(x))\n\\]\nå¾“ã£ã¦ï¼Œ\n\\[\n\\hat\\sigma_{F_n(x)} \\overset{p}{\\to} \\sigma_{F_n(x)}\n\\]\næ¬¡ã«Slutskyã®å®šç†ã‚’é©ç”¨ã™ã‚‹ã¨\n\n\\[\n\\begin{align}\n\\frac{F_n(x) - F(x)}{\\hat\\sigma_{F_n(x)}}\n  &= \\frac{F_n(x) - F(x)}{\\sigma_{F_n(x)}}\\frac{{\\sigma_{F_n(x)}}}{\\hat\\sigma_{F_n(x)}}\\\\\n  &\\overset{d}{\\to} N(0, 1)\n\\end{align}\n\\]\n\nå¾“ã£ã¦ï¼Œpointwise 95% confidence intervalã¯\n\n\\[\n\\begin{align}\nF_n(x) \\pm z_{0.025}\\sqrt{\\frac{F_n(x)(1- F_n(x))}{n}} \\label{eq-plugin-ci}\n\\end{align}\n\\]\n\nPointwise CIã®å•é¡Œç‚¹\n\\(\\eqref{eq-plugin-ci}\\) ã¯å„ç‚¹ \\(x\\) ã«å¿œã˜ã¦å®šã¾ã‚‹ã¨ã„ã†å•é¡Œç‚¹ãŒã‚ã‚Šã¾ã™ï¼ä¾‹ãˆã°ï¼Œ\\(x \\in (0, 1)\\) åŒºé–“ã§æ¨å®šã—ãŸEDFã«åŸºã¥ã„ã¦åˆ†å¸ƒé–¢æ•°ã‚’ãƒ—ãƒ­ãƒƒãƒˆã—ãŸã¨ã—ã¾ã™ï¼\\(x \\in (0, 1)\\) ã‚’20å€‹ pickupã—ã¦CIã‚’ãƒ—ãƒ­ãƒƒãƒˆã—ãŸã¨ã—ã¦ã‚‚ï¼Œå°‘ãªãã¨ã‚‚ï¼‘ã¤ãã‚‰ã„ã¯å®Œå…¨ã«targetã¨ãªã‚‹ã‚ˆã†ãªtrue CDFã‹ã‚‰é€¸è„±ã—ãŸplotã¨ãªã£ã¦ã„ã‚‹ã¯ãšã§ã™ï¼\nEDFæ¨å®šé‡ã‚’ç”¨ã„ãŸåˆ†æã§æœ¬å½“ã«ã»ã—ã„Intervalã¯Pointwise CIã§ã¯ãªãï¼Œ\n\\[\nP_F (L(X, x) \\leq F(x) \\leq U(X, x) \\,  \\ \\forall x) \\geq 1 âˆ’ \\alpha\n\\]\nã¨ãªã‚‹ã‚ˆã†ãªCI, simultaneous CIã®å ´åˆãŒå¤šã„ã¯ãšã§ã™ï¼too conservativeã™ãã¦ã‚ã¾ã‚Šä½¿ã‚ã‚Œãªã„ã§ã™ãŒï¼Œï¼‘ã¤ã®æ‰‹æ³•ã¨ã—ã¦Dvoretsky-Kiefer-Wolfowitz inequalityãŒã‚ã‚Šã¾ã™ï¼\n\\[\n\\operatorname{Pr}\\left(\\sqrt{n}\\sup_{x\\in\\mathbb{R}}\\left|F_{n}\\left(x\\right) - F\\left(x\\right)\\right| &gt; \\epsilon\\right) \\leq 2e^{-2\\epsilon^{2}}\n\\]\nã“ã‚Œã‚’å¤‰å½¢ã•ã›ã‚‹ã¨\n\\[\n\\operatorname{Pr}\\left(\\sup_{x\\in\\mathbb{R}}\\left|F_{n}\\left(x\\right) - F\\left(x\\right)\\right| &gt; \\sqrt{\\frac{-\\log(\\alpha/2)}{2n}}\\right) \\leq \\alpha\n\\]\næœ€å¾Œã®å¼å¤‰å½¢ã¯\n\\(\\{X_1, X_2, \\cdots, X_n\\}\\) ã®å®Ÿç¾å€¤ \\(x_1, \\cdots, x_n\\) ã‚’å›ºå®šã—ã¦è€ƒãˆã‚‹ã¨ï¼Œã‚‚ã—äº’ã„ã«å…¨ã¦ãƒãƒ©ãƒãƒ©ãªå€¤ã®ã¨ãã¯ï¼Œ \\(F_n(x)\\) ã¯å„ \\(x_i\\) ã§ \\(1/n\\) ã ã‘ã‚¸ãƒ£ãƒ³ãƒ—ã—ï¼Œä»–ã® \\(x\\) ã«ã¤ã„ã¦ã¯å¹³ã‚‰ãªéšæ®µé–¢æ•°(å³å´é€£ç¶šé–¢æ•°)ã¨ãªã‚Šã¾ã™ï¼éšæ®µé–¢æ•°ã¯å¾®åˆ†ä¸å¯èƒ½ãªã®ã§ï¼Œåˆ†å¸ƒé–¢æ•°ãŒæ¨å®šã§ããŸã¨ã—ã¦ã‚‚å¯†åº¦é–¢æ•°ã®æ¨å®šé‡ã‚’çµŒé¨“åˆ†å¸ƒé–¢æ•°ã‹ã‚‰æ§‹æˆã™ã‚‹ã“ã¨ã¯ãªã«ã‹åˆ¥ã®æ–¹æ³•ã‚’è€ƒãˆã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ï¼",
    "crumbs": [
      "Part 1: å¯†åº¦é–¢æ•°ã®æ¨å®š",
      "<span class='chapter-number'>2</span>Â  <span class='chapter-title'>ãƒ’ã‚¹ãƒˆã‚°ãƒ©ãƒ ã®æ€§è³ª</span>"
    ]
  },
  {
    "objectID": "glossary.html",
    "href": "glossary.html",
    "title": "Glossary",
    "section": "",
    "text": "ç”¨èª\nComment\n\n\n\n\nCPS\nCurrent Population Survey\n\n\nãƒãƒ³ãƒ‘ãƒ©ãƒ¡ãƒˆãƒªãƒƒã‚¯æ¨å®š\nä½•ã‚‰ã‹ã®é–¢æ•°ã‚’æ¨å®šã™ã‚‹éš›ã«ï¼Œäº‹å‰ã«é–¢æ•°ç³»ã‚’ç‰¹å®šã›ãšã«æ¨å®šã™ã‚‹æ–¹æ³•",
    "crumbs": [
      "Glossary"
    ]
  },
  {
    "objectID": "references.html",
    "href": "references.html",
    "title": "References",
    "section": "",
    "text": "DiNardo, J., Fortin, N. M., and Lemieux, T. (1996), â€œLabor market\ninstitutions and the distribution of wages, 1973-1992: A semiparametric\napproach,â€ Econometrica, USA: The Econometric Society,\n64, 1001â€“1044. https://doi.org/10.2307/2171954.\n\n\nLockhart, R. (2013), â€œNonparametric basics: Lecture notes,â€\nSimon Fraser University; https://www.sfu.ca/~lockhart/richard/830/13_3/lectures/nonparametric_basics/notes.pdf.\n\n\nå‰åœ’å®œå½¦ (2025), ãƒãƒ³ãƒ‘ãƒ©ãƒ¡ãƒˆãƒªãƒƒã‚¯æ³•:\nã‚«ãƒ¼ãƒãƒ«å‹æ¨å®šã«ã‚ˆã‚‹çµ±è¨ˆçš„æ€§è³ª, çµ±è¨ˆå­¦One point, Tokyo, Japan:\nå…±ç«‹å‡ºç‰ˆ, p. 128.",
    "crumbs": [
      "References"
    ]
  }
]